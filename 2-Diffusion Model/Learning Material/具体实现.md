使用U-Net



https://www.assemblyai.com/blog/content/images/size/w1600/2022/05/image-20.png

https://www.assemblyai.com/blog/diffusion-models-for-machine-learning-introduction/



关于如何设置beta参数

DDPM里使用

a linearly spaced schedule from 0.0001 at t=0 to 0.02 at t=T.






$$
x_0=\sqrt{\frac{1}{\overline{\alpha_t}}} x_t-\sqrt{\frac{1}{\overline{\alpha_t}}-1} \in \text { where } \epsilon \sim \mathcal{N}(\mathbf{0}, \mathbf{1})
$$




代码中的变量对应





sqrt_alphas_cumprod

sqrt_one_minus_alphas_cumprod






$$
q\left(x_{t-1} \mid x_t, x_0\right)=\mathcal{N}\left(x_{t-1} ; \tilde{\mu}_t\left(x_t, x_0\right), \tilde{\beta}_t \mathbf{I}\right)
\\
= 
$$









反向过程的方差建模



### variance schedule

原文当中的设计是线性增加的，$\beta_1 = 10^{-4}$ to $\beta_T=0.02$



后来提出了cosine-based variance schedule 并说只要这个变化符合，中间几乎线性，首尾变化很小就行。
$$
\beta_t = \text{clip}(1-\frac{\bar{\alpha}_t}{\bar{\alpha}_{t-1}}) \quad \bar{\alpha}_t=\frac{f(t)}{f_0} \quad f(f)=\cos \left(\frac{t / T+s}{1+s} \cdot \frac{\pi}{2}\right)
$$
![img](https://raw.githubusercontent.com/yzy1996/Image-Hosting/master/diffusion-beta.png)







### 
